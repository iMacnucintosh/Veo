<!DOCTYPE html>
<html lang="es">
<head>
    {% include "includes/head.html" %}

    <title>Veo | Perfil</title>

    <script src="https://www.amcharts.com/lib/4/core.js"></script>
    <script src="https://www.amcharts.com/lib/4/charts.js"></script>
    <script src="https://www.amcharts.com/lib/4/themes/animated.js"></script>

    <style>
        #chartdiv {
            width: 100%;
            height: 300px;
        }
    </style>

</head>
<body>

<header>
    <nav class="header-navBar">

        <div class="nav-wrapper search-field">
            <form id="search">
                <div class="input-field">
                    <input id="search" type="search" placeholder="Introduce el título a buscar" autofocus required>
                    <i class="material-icons">close</i>
                </div>
            </form>
        </div>

        <div class="header-title">
            <h1 id="title">{{ profile_visited.user.username }}</h1>
        </div>

        <div class="img-profile-container">
            <div class="img-profile"><img src="{{ profile_visited.avatar.src }}" /></div>
        </div>

        <div class="search-container">
            <a>
                <i class="material-icons">search</i>
            </a>
        </div>

    </nav>
</header>
<!-- Tabs -->
<ul class="tabs">
    <li class="tab col s3"><a class="tab-btn active" href="#home_profile">Resumen</a></li>
    <li class="tab col s3"><a class="tab-btn" href="#activity">Actividad</a></li>
    <li class="tab col s3"><a class="tab-btn" href="#lists">Listas</a></li>
</ul>

<main class="main-home">
    <section id="home_profile" class="col s12 row no-margin">
        <article class="stadistics-profile row no-margin">
            <div class="col s6 m3">
                <a class="statistic-profile-item deep-purple row no-margin tooltipped" data-position="bottom" data-tooltip="Películas Vistas">
                    <span>{{ profile_visited.getMoviesSeen }}</span>
                    <i class="material-icons">movie</i>
                </a>
            </div>

            <div class="col s6 m3">
                <a class="statistic-profile-item orange row no-margin tooltipped" data-position="bottom" data-tooltip="Series Vistas">
                    <span>{{ profile_visited.getShowsSeen }}</span>
                    <i class="material-icons">subscriptions</i>
                </a>
            </div>

            <div class="col s6 m3">
                <a class="statistic-profile-item teal row no-margin tooltipped" data-position="bottom" data-tooltip="Capítulos Vistos">
                    <span>{{ profile_visited.getEpisodesSeen }}</span>
                    <i class="material-icons">view_carousel</i>
                </a>
            </div>

            <div class="col s6 m3">
                <a class="statistic-profile-item blue row no-margin tooltipped" data-position="bottom" data-tooltip="Listas Creadas">
                    <span>0</span>
                    <i class="material-icons">list</i>
                </a>
            </div>
        </article>

        <article class="col s12 title-section">
            <h4>Actividad</h4>
        </article>

        <article class="chart-stadistics row no-margin">

            <script>
                am4core.ready(function() {


                    am4core.useTheme(am4themes_animated);


                    var chart = am4core.create("chartdiv", am4charts.XYChart);

                    var data = [];
                    {% for activity in activitys_dir %}
{#                        var date = new Date({{ activity.year }}, {{ activity.month }}, {{ activity.day }});#}
{#                        date.setHours(0,0,0,0);#}
{#                        date.setDate(date);#}
                        data.push({date:new Date({{ activity.year }}, {{ activity.month }}, {{ activity.day }}), value: {{ activity.n_activitys }} });
                    {% endfor %}

                    chart.data = data;


                    var dateAxis = chart.xAxes.push(new am4charts.DateAxis());
                    dateAxis.renderer.minGridDistance = 60;

                    var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());


                    var series = chart.series.push(new am4charts.LineSeries());
                    series.dataFields.valueY = "value";
                    series.dataFields.dateX = "date";
                    series.tooltipText = "{value}"

                    series.tooltip.pointerOrientation = "vertical";

                    chart.cursor = new am4charts.XYCursor();
                    chart.cursor.snapToSeries = series;
                    chart.cursor.xAxis = dateAxis;


                    chart.scrollbarX = new am4core.Scrollbar();

                });
            </script>

            <!-- HTML -->
            <div id="chartdiv"></div>
        </article>

    </section>

    <section id="activity" class="col s12 row no-margin">
        {% for activity in activitys %}

            <div class="activity-item row no-margin">
                <a href="{{ activity.getHref }}" class="poster-activity">
                    <img src="{{ activity.getPosterPath }}" />
                </a>
                <div class="information-activity">
                    <div class="col s12 date-activity no-padding">
                        <p>{{ activity.getDate }}</p>
                    </div>
                    <div class="col s12 description-activity no-padding">
                        <p>{{ activity.getDescription|safe }}</p>
                    </div>
                </div>
            </div>
        {% endfor %}

    </section>

    <section id="lists" class="col s12 row no-margin">
        <p class="infoPeticion">Disponible próximamente...</p>
    </section>

    <div id="home-shows-active" class="col s12 row no-margin"></div>
</main>

<div class="gif-loading">
    <div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div>
</div>


<!-- Button navbar-->
<footer>
    <nav class="bottom-navBar row no-margin">
        <a href="/" id="nav-home" class="col s3">
            <i class="material-icons">home</i>
            <p>Inicio</p>
        </a>
        <a href="/movies" id="nav-movies" class="col s3" onclick="localStorage.setItem('active_tab', '#movies_popularity')">
            <i class="material-icons">movie</i>
            <p>Películas</p>
        </a>
        <a href="/shows" id="nav-shows" class="col s3" onclick="localStorage.setItem('active_tab', '#shows_popularity')">
            <i class="material-icons">subscriptions</i>
            <p>Series</p>
        </a>
        <a href="/social" id="nav-social" class="col s3">
            <i class="material-icons">group</i>
            <p>Amigos</p>
        </a>
    </nav>
</footer>


<!-- Loading Gif -->
<section class="loading-container">
    <div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div>
</section>

{% include "includes/body_end.html" %}

<script>

    $(document).ready(function(){
        {% if profile.celularDataSavings == True %} localStorage.setItem("width_poster", "200"); {% else %} localStorage.setItem("width_poster", "400"); {% endif %}

        /* ---------------------------------- PERSONAL DATABASE ----------------------------------------------------- */
        $('.gif-loading').fadeOut(100);
        $("main").addClass("main-active");
    });

</script>

</body>
</html>